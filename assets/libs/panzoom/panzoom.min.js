/**
 * Panzoom for panning and zooming elements using CSS transforms
 * Copyright Timmy Willison and other contributors
 * https://github.com/timmywil/panzoom/blob/master/MIT-License.txt
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Panzoom=e()}(this,function(){"use strict";var r,Y=function(){return(Y=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},a=document.createElement("div").style,i=["webkit","moz","ms"],l={};function p(t){if(l[t])return l[t];if(t in a)return l[t]=t;for(var e=t[0].toUpperCase()+t.slice(1),n=i.length;n--;){var o=""+i[n]+e;if(o in a)return l[t]=o}}function s(t,e){return parseFloat(e[p(t)])||0}function c(t,e,n){void 0===n&&(n=window.getComputedStyle(t));var o="border"===e?"Width":"";return{left:s(e+"Left"+o,n),right:s(e+"Right"+o,n),top:s(e+"Top"+o,n),bottom:s(e+"Bottom"+o,n)}}function P(t,e,n){t.style[p(e)]=n}function S(t){var e=t.parentElement,n=window.getComputedStyle(t),o=window.getComputedStyle(e),r=t.getBoundingClientRect(),a=e.getBoundingClientRect();return{elem:{style:n,width:r.width,height:r.height,top:r.top,bottom:r.bottom,left:r.left,right:r.right,margin:c(t,"margin",n),border:c(t,"border",n)},parent:{style:o,width:a.width,height:a.height,top:a.top,bottom:a.bottom,left:a.left,right:a.right,padding:c(e,"padding",o),border:c(e,"border",o)}}}function C(t,e,n,o){r[t].split(" ").forEach(function(t){e.addEventListener(t,n,o)})}function O(t,e,n){r[t].split(" ").forEach(function(t){e.removeEventListener(t,n)})}r="function"==typeof window.PointerEvent?{down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:"function"==typeof window.TouchEvent?{down:"touchstart",move:"touchmove",up:"touchend touchcancel"}:{down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};var T=/^http:[\w\.\/]+svg$/;function A(t,e){for(var n=t.length;n--;)if(t[n].pointerId===e.pointerId)return n;return-1}function L(t,e){var n;if(e.touches)for(var o=n=0,r=e.touches;o<r.length;o++){var a=r[o];a.pointerId=n++,L(t,a)}else-1<(n=A(t,e))&&t.splice(n,1),t.push(e)}function I(t){for(var e,n=(t=t.slice(0)).pop();e=t.pop();)n={clientX:(e.clientX-n.clientX)/2+n.clientX,clientY:(e.clientY-n.clientY)/2+n.clientY};return n}function W(t){if(t.length<2)return 0;var e=t[0],n=t[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-e.clientX),2)+Math.pow(Math.abs(n.clientY-e.clientY),2))}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n});var Z={animate:!1,clickableClass:"clickable",cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",maxScale:4,minScale:.125,panOnlyWhenZoomed:!1,relative:!1,setTransform:function(t,e,n){var o=e.x,r=e.y,a=e.scale;void 0===n&&(n={}),"boolean"==typeof n.animate&&(n.animate?function(t,e){P(t,p("transition"),p("transform")+" "+e.duration+"ms "+e.easing)}(t,n):P(t,"transition","none")),requestAnimationFrame(function(){P(t,"transform","scale("+a+") translate("+o+"px, "+r+"px)")})},startX:0,startY:0,startScale:1,step:.3};function t(s,p){if(!s)throw new Error("Panzoom requires an element as an argument");if(1!==s.nodeType)throw new Error("Panzoom requires an element with a nodeType of 1");if(!function(t){var e=t.ownerDocument,n=t.parentElement;return e&&n&&9===e.nodeType&&1===n.nodeType&&e.contains(n)}(s))throw new Error("Panzoom should be called on elements that have been attached to the DOM");p=Y(Y({},Z),p);var c=function(t){return T.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase()}(s);var t=s.parentElement;t.style.overflow="hidden",t.style.userSelect="none",t.style.touchAction="none",s.style.cursor=p.cursor,s.style.userSelect="none",s.style.touchAction="none",P(s,"transformOrigin","string"==typeof p.origin?p.origin:c?"0 0":"50% 50%");var n,o,r,a,i,l,d=0,u=0,m=1,f=!1;function h(t,e,n){if(!n.silent){var o=new CustomEvent(t,{detail:e});s.dispatchEvent(o)}}function v(t,e){var n={x:d,y:u,scale:m};return e.setTransform(s,n,e),h(t,n,e),h("panzoomchange",n,e),n}function g(t,e,n){var o=Y(Y({},p),n),r={x:d,y:u,opts:o};if(o.disablePan||o.panOnlyWhenZoomed&&m===o.startScale)return r;if(t=parseFloat(t),e=parseFloat(e),o.disableXAxis||(r.x=(o.relative?d:0)+t),o.disableYAxis||(r.y=(o.relative?u:0)+e),"inside"===o.contain){var a=S(s);r.x=Math.max(-a.elem.margin.left-a.parent.padding.left,Math.min(a.parent.width-a.elem.width/m-a.parent.padding.left-a.elem.margin.left-a.parent.border.left-a.parent.border.right,r.x)),r.y=Math.max(-a.elem.margin.top-a.parent.padding.top,Math.min(a.parent.height-a.elem.height/m-a.parent.padding.top-a.elem.margin.top-a.parent.border.top-a.parent.border.bottom,r.y))}else if("outside"===o.contain){var i=((a=S(s)).elem.width-a.elem.width/m)/2,l=(a.elem.height-a.elem.height/m)/2;r.x=Math.max(Math.min(r.x,(i-a.parent.padding.left)/m),(-(a.elem.width-a.parent.width)-a.parent.padding.left-a.parent.border.left-a.parent.border.right+i)/m),r.y=Math.max(Math.min(r.y,(l-a.parent.padding.top)/m),(-(a.elem.height-a.parent.height)-a.parent.padding.top-a.parent.border.top-a.parent.border.bottom+l)/m)}return r}function b(t,e){var n=Y(Y({},p),e),o={scale:m,opts:n};return n.disableZoom||(o.scale=Math.min(Math.max(t,n.minScale),n.maxScale)),o}function y(t,e,n){var o=g(t,e,n),r=o.opts;return d=o.x,u=o.y,v("panzoompan",r)}function w(t,e){var n=b(t,e),o=n.opts;if(!o.disableZoom){if(t=n.scale,o.focal){var r=o.focal,a=g((r.x/t-r.x/m+d*t)/t,(r.y/t-r.y/m+u*t)/t,{relative:!1});d=a.x,u=a.y}return m=t,v("panzoomzoom",o)}}function e(t,e){var n=Y(Y(Y({},p),{animate:!0}),e);return w(m*Math.exp((t?1:-1)*n.step),n)}function x(t,e,n){var o=S(s),r=o.parent.width-o.parent.padding.left-o.parent.padding.right-o.parent.border.left-o.parent.border.right,a=o.parent.height-o.parent.padding.top-o.parent.padding.bottom-o.parent.border.top-o.parent.border.bottom,i=e.clientX-o.parent.left-o.parent.padding.left-o.parent.border.left-o.elem.margin.left,l=e.clientY-o.parent.top-o.parent.padding.top-o.parent.border.top-o.elem.margin.top;c||(i-=o.elem.width/m/2,l-=o.elem.height/m/2);var p={x:i/r*(r*t),y:l/a*(a*t)};return w(t,Y(Y({},n),{focal:p,animate:!1}))}w(p.startScale,{animate:!1}),setTimeout(function(){y(p.startX,p.startY,{animate:!1})});var E=[];function M(t){if(!t.target||!t.target.classList.contains(p.clickableClass)){L(E,t),f=!0,t.preventDefault(),t.stopPropagation(),h("panzoomstart",{x:n=d,y:o=u,scale:m},p);var e=I(E);r=e.clientX,a=e.clientY,i=m,l=W(E)}}function z(t){if(f&&void 0!==n&&void 0!==o&&void 0!==r&&void 0!==a){L(E,t);var e=I(E);if(1<E.length)x(b((W(E)-l)*p.step/80+i).scale,e);y(n+(e.clientX-r)/m,o+(e.clientY-a)/m,{animate:!1})}}function X(t){!function(t,e){if(e.touches)for(;t.length;)t.pop();else{var n=A(t,e);-1<n&&t.splice(n,1)}}(E,t),f&&(1===E.length&&h("panzoomend",{x:d,y:u,scale:m},p),f=!1,n=o=r=a=void 0)}return p.disablePan||(C("down",s,M),C("move",document,z,{passive:!0}),C("up",document,X,{passive:!0})),{destroy:function(){O("down",s,M),O("move",document,z),O("up",document,X)},getPan:function(){return{x:d,y:u}},getScale:function(){return m},getOptions:function(){return function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(p)},pan:y,reset:function(t){var e=Y(Y(Y({},p),{animate:!0}),t),n=g(e.startX,e.startY,e);return d=n.x,u=n.y,m=b(e.startScale,e).scale,v("panzoomreset",e)},setOptions:function(t){for(var e in void 0===t&&(t={}),t)t.hasOwnProperty(e)&&(p[e]=t[e]);t.hasOwnProperty("cursor")&&(s.style.cursor=t.cursor)},setStyle:P,zoom:w,zoomIn:function(t){return e(!0,t)},zoomOut:function(t){return e(!1,t)},zoomToPoint:x,zoomWithWheel:function(t,e){t.preventDefault();var n=Y(Y({},p),e),o=(0===t.deltaY&&t.deltaX?t.deltaX:t.deltaY)<0?1:-1;return x(b(m*Math.exp(o*n.step/3),n).scale,t,n)}}}return t.defaultOptions=Z,t});